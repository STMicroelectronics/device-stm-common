From a8d6551517500ec13f28dbe5187b7d93502f5e9e Mon Sep 17 00:00:00 2001
From: jenkins <jenkins@jenkins>
Date: Mon, 18 Feb 2019 16:27:12 +0100
Subject: [PATCH 2/2] Temporary fix to access connected devices

Change-Id: If574aee8371f9e599c49f7e2061159e5eb02b222
---
 .../settings/connecteddevice/ConnectedDeviceDashboardFragment.java  | 6 +++---
 .../settings/connecteddevice/ConnectedDeviceGroupController.java    | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/src/com/android/settings/connecteddevice/ConnectedDeviceDashboardFragment.java b/src/com/android/settings/connecteddevice/ConnectedDeviceDashboardFragment.java
index 482c45f..c1a75be 100644
--- a/src/com/android/settings/connecteddevice/ConnectedDeviceDashboardFragment.java
+++ b/src/com/android/settings/connecteddevice/ConnectedDeviceDashboardFragment.java
@@ -70,13 +70,13 @@ public class ConnectedDeviceDashboardFragment extends DashboardFragment {
     private static List<AbstractPreferenceController> buildPreferenceControllers(Context context,
             Lifecycle lifecycle) {
         final List<AbstractPreferenceController> controllers = new ArrayList<>();
-        final DiscoverableFooterPreferenceController discoverableFooterPreferenceController =
+        /*final DiscoverableFooterPreferenceController discoverableFooterPreferenceController =
                 new DiscoverableFooterPreferenceController(context);
         controllers.add(discoverableFooterPreferenceController);
 
         if (lifecycle != null) {
             lifecycle.addObserver(discoverableFooterPreferenceController);
-        }
+        }*/
 
         return controllers;
     }
@@ -87,7 +87,7 @@ public class ConnectedDeviceDashboardFragment extends DashboardFragment {
         use(AvailableMediaDeviceGroupController.class).init(this);
         use(ConnectedDeviceGroupController.class).init(this);
         use(PreviouslyConnectedDevicePreferenceController.class).init(this);
-        use(DiscoverableFooterPreferenceController.class).init(this);
+        //use(DiscoverableFooterPreferenceController.class).init(this);
     }
 
     @VisibleForTesting
diff --git a/src/com/android/settings/connecteddevice/ConnectedDeviceGroupController.java b/src/com/android/settings/connecteddevice/ConnectedDeviceGroupController.java
index e97683d..ba17580 100644
--- a/src/com/android/settings/connecteddevice/ConnectedDeviceGroupController.java
+++ b/src/com/android/settings/connecteddevice/ConnectedDeviceGroupController.java
@@ -72,15 +72,15 @@ public class ConnectedDeviceGroupController extends BasePreferenceController
     @Override
     public void displayPreference(PreferenceScreen screen) {
         super.displayPreference(screen);
+        mPreferenceGroup = (PreferenceGroup) screen.findPreference(KEY);
         if (isAvailable()) {
-            mPreferenceGroup = (PreferenceGroup) screen.findPreference(KEY);
             mPreferenceGroup.setVisible(false);
 
             mBluetoothDeviceUpdater.setPrefContext(screen.getContext());
             mBluetoothDeviceUpdater.forceUpdate();
-            mConnectedUsbDeviceUpdater.initUsbPreference(screen.getContext());
-            mConnectedDockUpdater.forceUpdate();
         }
+        mConnectedUsbDeviceUpdater.initUsbPreference(screen.getContext());
+        mConnectedDockUpdater.forceUpdate();
     }
 
     @Override
-- 
2.7.4

