From 0a77f3816c900bf21d83b87ee533429df5f5acfe Mon Sep 17 00:00:00 2001
From: frq09432 <nicolas.louboutin@st.com>
Date: Thu, 23 Jan 2020 16:16:17 +0100
Subject: [PATCH] Integration of Copro HAL

Change-Id: I4c37708e0f790ff8061cf83f9e5ce477813bea50
---
 copro/1.0/Android.bp              | 23 +++++++++++++++
 copro/1.0/ICopro.hal              | 62 +++++++++++++++++++++++++++++++++++++++
 copro/1.0/ICoproSerialPortHal.hal | 52 ++++++++++++++++++++++++++++++++
 copro/1.0/types.hal               | 53 +++++++++++++++++++++++++++++++++
 current.txt                       |  5 ++++
 5 files changed, 195 insertions(+)
 create mode 100644 copro/1.0/Android.bp
 create mode 100644 copro/1.0/ICopro.hal
 create mode 100644 copro/1.0/ICoproSerialPortHal.hal
 create mode 100644 copro/1.0/types.hal

diff --git a/copro/1.0/Android.bp b/copro/1.0/Android.bp
new file mode 100644
index 0000000..582b95f
--- /dev/null
+++ b/copro/1.0/Android.bp
@@ -0,0 +1,23 @@
+// This file is autogenerated by hidl-gen -Landroidbp.
+
+hidl_interface {
+    name: "android.hardware.copro@1.0",
+    root: "android.hardware",
+    vndk: {
+        enabled: true,
+    },
+    srcs: [
+        "types.hal",
+        "ICopro.hal",
+        "ICoproSerialPortHal.hal",
+    ],
+    interfaces: [
+        "android.hidl.base@1.0",
+    ],
+    types: [
+        "HalFwInfo",
+        "RequestStatus",
+        "TtyMode",
+    ],
+    gen_java: true,
+}
diff --git a/copro/1.0/ICopro.hal b/copro/1.0/ICopro.hal
new file mode 100644
index 0000000..c336ae3
--- /dev/null
+++ b/copro/1.0/ICopro.hal
@@ -0,0 +1,62 @@
+/*
+ * Copyright (C) 2016 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.hardware.copro@1.0;
+
+interface ICopro {
+    /**
+     * This function return the fw list.
+     *
+     * @param   void
+     * @return  debugErrno
+     * @return  fwInfoList
+     */
+    getFwList() generates (RequestStatus debugErrno, vec<HalFwInfo> fwInfoList);
+
+    /**
+     * This function return the fw info.
+     *
+     * @param   void
+     * @return  debugErrno
+     * @return  fwInfo
+     */
+    getFwByName(string name) generates (RequestStatus debugErrno, HalFwInfo fwInfo);
+
+    /**
+     * This function return if the fw is running.
+     *
+     * @param   id
+     * @return  debugErrno
+     * @return  runningState
+     */
+    isFwRunning(uint32_t id) generates (RequestStatus debugErrno, bool runningState);
+
+    /**
+     * This function start the fw.
+     *
+     * @param   id
+     * @return  debugErrno
+     */
+    startFw(uint32_t id) generates (RequestStatus debugErrno);
+
+    /**
+     * This function stop the fw.
+     *
+     * @param   id
+     * @return  debugErrno
+     */
+    stopFw(uint32_t id) generates (RequestStatus debugErrno);
+};
diff --git a/copro/1.0/ICoproSerialPortHal.hal b/copro/1.0/ICoproSerialPortHal.hal
new file mode 100644
index 0000000..a74de06
--- /dev/null
+++ b/copro/1.0/ICoproSerialPortHal.hal
@@ -0,0 +1,52 @@
+/*
+ * Copyright (C) 2016 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.hardware.copro@1.0;
+
+interface ICoproSerialPortHal {
+    /**
+     * It open the tty connection.
+     *
+     * @param   mode
+     * @return  debugErrno
+     */
+    open(TtyMode mode) generates (RequestStatus debugErrno);
+
+    /**
+     * It close the tty connection.
+     *
+     * @param   void
+     * @return  debugErrno
+     */
+    close() generates (RequestStatus debugErrno);
+
+    /**
+     * Read the content of the tty connection.
+     *
+     * @param   void
+     * @return  debugErrno
+     * @return  result
+     */
+    read() generates (RequestStatus debugErrno, string result);
+
+    /**
+     * Wrtie data to the tty.
+     *
+     * @param   command
+     * @return  debugErrno
+     */
+    write(string command) generates (RequestStatus debugErrno);
+};
diff --git a/copro/1.0/types.hal b/copro/1.0/types.hal
new file mode 100644
index 0000000..c1c85bd
--- /dev/null
+++ b/copro/1.0/types.hal
@@ -0,0 +1,53 @@
+/*
+ * Copyright (C) 2016 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package android.hardware.copro@1.0;
+
+enum TtyMode : uint32_t {
+    /**
+     * TTY in NORMAL mode
+     */
+    MODE_NORMAL = 0,
+
+    /**
+     * TTY in RAW mode
+     */
+    MODE_RAW = 1,
+};
+
+/**
+ * Used as a container to send port role information.
+ */
+struct HalFwInfo {
+    /**
+     * The firware ID
+     */
+    uint32_t id;
+
+    /**
+     * The firmware name
+     */
+    string name;
+
+    /**
+     * The firmware state
+     */
+    bool state;
+};
+
+struct RequestStatus { /* Voir si on fait des exceptions, ou string etc... */
+    bool ret; /* Voir si besoin de plus de pr√©cision sur le retour */
+};
diff --git a/current.txt b/current.txt
index 47e7d72..da0b661 100644
--- a/current.txt
+++ b/current.txt
@@ -570,3 +570,8 @@ f3dbd8dd0d6333c005610288a4785d0ef79a72a7bbe6d0a46d46fa89fc886f1e android.hardwar
 09e08b5d12b109562ecdd8882532fd1f2c4639588e07769d5c7396b7c5b9f34f android.hardware.wifi.supplicant@1.2::ISupplicantStaIfaceCallback
 efbb061c969fa9553d243da6ee23b83fe5d4aa663a7b8896adc52e2b015bc2f3 android.hardware.wifi.supplicant@1.2::ISupplicantStaNetwork
 cfa81f229b69f9011c58f48264fcb552447430fe68610eac514e811e65bc306a android.hardware.wifi.supplicant@1.2::types
+
+# Add Copro HALs
+fe093bf4dacfd048c1be7b233ac6bd678f0f33bbeb812fd4364bcc82f12d0de4 android.hardware.copro@1.0::types
+ad7e5475dd5de5e956bd0d781bb9d29891e88639c7327f4ae4d3e2dc96cdd64a android.hardware.copro@1.0::ICopro
+62d7af09e29f78070dc5bd9d711a345cf7e1427ba70fc1636715e829d51f96d7 android.hardware.copro@1.0::ICoproSerialPortHal
-- 
2.7.4

