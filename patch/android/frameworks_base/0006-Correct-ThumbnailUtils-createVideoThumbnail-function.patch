From c050dea5dec3ca71cb92cfc614d0d02f828757c2 Mon Sep 17 00:00:00 2001
From: frq09432 <nicolas.louboutin@st.com>
Date: Tue, 12 Nov 2019 16:38:17 +0100
Subject: [PATCH 06/12] Correct ThumbnailUtils createVideoThumbnail function
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Getting back mettadata for key duration, returned a value in ms
while the getFrameAtTime/getScaledFrameAtTime expect a value in Âµs.

Change-Id: I7ce49fb7afbb1f4f764651927ebe945c086f4d9a
---
 media/java/android/media/ThumbnailUtils.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/media/java/android/media/ThumbnailUtils.java b/media/java/android/media/ThumbnailUtils.java
index 534d63b..122d428 100644
--- a/media/java/android/media/ThumbnailUtils.java
+++ b/media/java/android/media/ThumbnailUtils.java
@@ -365,10 +365,10 @@ public class ThumbnailUtils {
             // return a frame without up-scaling it
             if (size.getWidth() > width && size.getHeight() > height) {
                 return Objects.requireNonNull(
-                        mmr.getFrameAtTime(duration / 2, OPTION_CLOSEST_SYNC));
+                        mmr.getFrameAtTime(duration * 1000 / 2, OPTION_CLOSEST_SYNC));
             } else {
                 return Objects.requireNonNull(
-                        mmr.getScaledFrameAtTime(duration / 2, OPTION_CLOSEST_SYNC,
+                        mmr.getScaledFrameAtTime(duration * 1000 / 2, OPTION_CLOSEST_SYNC,
                         size.getWidth(), size.getHeight()));
             }
         } catch (RuntimeException e) {
-- 
2.7.4

