# Add insmod capability within kernel (load modules in STM init)
allow kernel device:chr_file { create getattr setattr unlink };
allow kernel device:dir { create write add_name remove_name rmdir };
allow kernel device:blk_file { getattr };
allow kernel removable_device:blk_file { create };

allow kernel self:capability mknod;
allow kernel self:capability sys_admin;
allow kernel vendor_file:file { open read };
allow kernel super_block_device:lnk_file relabelto;
allow kernel dm_device:blk_file { open read };

allow kernel sepolicy_file:file getattr;

r_dir_file(kernel, system_bootstrap_lib_file)
r_dir_file(kernel, vendor_firmware_file)

userdebug_or_eng(`
allow kernel debugfs_tracing:filesystem mount;
allow kernel debugfs_regulator:dir search;
')
